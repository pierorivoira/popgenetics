# popgenetics
Welcome to R package popgenetics!
=======
Welcome to R (future) package popgenetics!
It includes two programs:
1) plot.all.1.0
2) probability.of.survival.2.or.more.lineages

########################################################################

plot.all.1.0 is the beta version of the software and it works only with 3 populations, 14 loci, and with the migration parameter 'M'. If you need to run plot.all.1.0 with more combinations of parameters, feel free to e-mail me at piero.rivoira@yahoo.it. Please do not edit this file unless you are perfectly aware of what you are doing. The program was designed to read the output file (bayesfile) of Peter Beerli's software «migrate». The bayesfile must first be converted to the excel format .xlsx; then plot.all.1.0 will read the migration parameter's posterior density's counts and plot them against the parameter's values for all the possible pairs of populations, and it will print the modes of the migration parameter's distributions. This R program can also compute and plot the quadratic approximations of these same densities.

INSTALLATION AND DATA PREPARATION INSTRUCTIONS

Download the program 
file <plot.all.1.0>
and the data file
<bayesfile.xlsx> 
from

https://github.com/pierorivoira/popgenetics/blob/main/R/plot.all.1.0

and

https://github.com/pierorivoira/popgenetics/blob/main/data/bayesfile.xlsx 

respectively

Press ctrl-alt-t to open the terminal and launch R

$ mkdir ~/popgenetics/data

$ mkdir ~/popgenetics/R

$ cp ~/Downloads/bayesfile.xlsx ~/popgenetics/data

$ cp ~/Downloads/plot.all.1.0 ~/popgenetics/R 

$ R

> install.packages("openxlsx")

> source("~/popgenetics/R/plot.all.1.0")

> plot.all.1.0()

Every time you need to re-run the software, please use the following commands:

> source('~/popgenetics/r/plot.all.1.0')

> plot.all.1.0()
EXAMPLE:
# output
[1] "#################################################################################################################################################################################"
[1] "WELCOME THE R PROGRAM print.all WRITTEN BY PIERO RIVOIRA. THIS IS THE BETA VERSION OF THE SOFTWARE AND IT WORKS ONLY WITH 3 populations, 14 loci, a number of bins of the posterior distribution = 1500, and with parameter 'M'. IF YOU NEED TO RUN print.all WITH MORE COMBINATIONS OF PARAMETERS, FEEL FREE TO E-MAIL ME AT piero.rivoira@yahoo.it. PLEASE DO NOT EDIT THIS FILE UNLESS YOU ARE PERFECTLY AWARE OF WHAT YOU ARE DOING. THE PROGRAM WILL PLOT THE POSTERIOR DENSITIES OF THE MIGRATION PARAMETERS OF ALL THE POSSIBLE PAIRS OF POPULATIONS OR, ALTERNATIVELY, THEIR QUADRATIC APPROXIMATIONS"
[1] "EVERY TIME YOU NEED TO RE-RUN THE SOFTWARE, PLEASE USE THE FOLLOWING COMMANDS"
[1] "source('~/popgenetics/R/plot.all')"
[1] "plot.all()"
[1] "PLEASE REMEMBER THAT THE DATA FILE MUST BE STORED IN '~/popgenetics/data' AND IT SHOULD BE AN EXCEL FILE (EXTENSION: 'xlsx')"
[1] "YOU WILL BE ASKED TO ENTER AS MANY COLORS AS THERE ARE PARAMETERS"
"########################################################################################################################################################################"
Please enter "y" if you want to continue or "n" to exit: y
Please enter file name: bayesfile
Please enter file extension: xlsx
Please enter parameter (gamma (gamma=ΘM) or M (M=m/μ)): M
Please enter the graph you would like to plot (PD = Posterior Density or QA = Quadratic Approximation): QA
Please enter the number of loci: 14
Please enter the number of bins of the posterior distribution: 1500
Please enter the number of populations: 3
Please enter background color: black
Please enter foreground color: white
Please enter axis color: white
Please enter first graph color: cyan
Please enter graph color: red
Please enter graph color: pink
Please enter graph color: white
Please enter graph color: green
Please enter graph color: blue
Please enter labels color: white
Please enter the line width of the graph: 5
[1] "256.333333" "257.000000" "205"        "342.333333" "81"        
[6] "227.666667" "237"       
> 

>>>>>>> refs/remotes/origin/main
